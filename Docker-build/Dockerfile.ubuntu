FROM ubuntu:18.04
RUN apt-get update
RUN apt-get install -y libczmq-dev libblas-dev g++ autoconf gdb git make cmake libtool uuid-dev
RUN apt-get install -y gfortran
WORKDIR /root
RUN mkdir -p src
WORKDIR /root/src
RUN git clone git://github.com/zeromq/czmq.git
WORKDIR /root/src/czmq
RUN apt-get install -y pkg-config
RUN ./autogen.sh && ./configure && make && make install && ldconfig
WORKDIR /
ENV LAPACK=lapack-3.8.0
RUN mkdir ${LAPACK}
RUN apt-get install -y curl
RUN /bin/bash -l -c '\
    curl -sSL "http://www.netlib.org/lapack/${LAPACK}.tar" | \
    tar xz && cd ${LAPACK} && \
    cp make.inc.example make.inc && \
    make blaslib && \
    make lapacklib -j 8 && cp liblapack.a /lib64 && \
    cp liblapack.a /usr/local/lib && cp librefblas.a /usr/local/lib && \
    cd LAPACKE && make && cd .. && cp liblapacke.a /usr/local/lib && \
    cd ../ && rm -rf ${LAPACK}'
# install python36 for AWS Lambda execution
RUN apt-get update && apt-get install -y python3.6 unzip libjansson-dev libmicrohttpd-dev 
